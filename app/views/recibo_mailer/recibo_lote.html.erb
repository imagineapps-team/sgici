<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Recibos de Reciclagem em Lote</title>
  <style type="text/css">
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      font-family: Arial, Helvetica, sans-serif;
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }
    .container {
      max-width: 700px;
      margin: 0 auto;
      background-color: #ffffff;
    }
    .header {
      text-align: center;
      padding: 30px 20px;
      background-color: #ffffff;
    }
    .logo {
      max-width: 220px;
      height: auto;
    }
    .content {
      padding: 20px 30px;
    }
    .summary {
      background-color: #04B4AE;
      color: #ffffff;
      padding: 20px;
      text-align: center;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .summary h2 {
      margin: 0;
      font-size: 24px;
    }
    .summary p {
      margin: 10px 0 0 0;
      font-size: 16px;
    }
    .recibo-card {
      border: 1px solid #dddddd;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .recibo-header {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid #eeeeee;
      padding-bottom: 10px;
      margin-bottom: 10px;
    }
    .recibo-codigo {
      font-size: 16px;
      font-weight: bold;
      color: #04B4AE;
    }
    .recibo-data {
      font-size: 14px;
      color: #666666;
    }
    .recibo-info {
      font-size: 14px;
      color: #333333;
      margin: 5px 0;
    }
    .recibo-bonus {
      font-size: 16px;
      font-weight: bold;
      color: #04B4AE;
      text-align: right;
      margin-top: 10px;
    }
    .items-list {
      font-size: 13px;
      color: #666666;
      margin: 10px 0;
      padding-left: 20px;
    }
    .items-list li {
      margin: 3px 0;
    }
    .total-section {
      background-color: #f8f8f8;
      padding: 20px;
      text-align: center;
      margin-top: 20px;
      border-radius: 8px;
    }
    .total-section h3 {
      margin: 0;
      font-size: 20px;
      color: #333333;
    }
    .total-value {
      font-size: 28px;
      font-weight: bold;
      color: #04B4AE;
      margin: 10px 0 0 0;
    }
    .planet-thanks {
      font-size: 22px;
      color: #04B4AE;
      text-align: center;
      margin: 30px 0;
    }
    .footer {
      background-color: #262626;
      padding: 20px;
      color: #ffffff;
      text-align: center;
    }
    .footer p {
      font-size: 14px;
      line-height: 22px;
      margin: 10px 0;
    }
    @media only screen and (max-width: 480px) {
      .container {
        width: 100% !important;
      }
      .content {
        padding: 15px !important;
      }
    }
  </style>
</head>
<body style="background-color: #f4f4f4; padding: 20px 0;">
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td align="center">
        <table class="container" width="700" border="0" cellspacing="0" cellpadding="0">
          <!-- Header com Logo -->
          <tr>
            <td class="header">
              <img src="<%= ENV.fetch('APP_URL', 'http://ecoenel.avsi.eco.br') %>/img/logo-light-recicla.jpg"
                   alt="Ecoenel" class="logo" width="220" />
            </td>
          </tr>

          <!-- Resumo -->
          <tr>
            <td class="content">
              <div class="summary">
                <h2>Recibos de Reciclagem</h2>
                <p><%= @total_registros %> registro(s) enviado(s)</p>
              </div>

              <!-- Lista de Recibos -->
              <% @resumo.each do |recibo| %>
                <div class="recibo-card">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td>
                        <span class="recibo-codigo">Nº <%= recibo[:codigo] %></span>
                      </td>
                      <td align="right">
                        <span class="recibo-data"><%= recibo[:data] %></span>
                      </td>
                    </tr>
                  </table>

                  <p class="recibo-info">
                    <strong>Beneficiário:</strong> <%= recibo[:cliente] %>
                  </p>

                  <% if recibo[:recursos].any? %>
                    <ul class="items-list">
                      <% recibo[:recursos].each do |item| %>
                        <li><%= item %></li>
                      <% end %>
                    </ul>
                  <% end %>

                  <p class="recibo-bonus">
                    Bônus: <%= number_to_currency(recibo[:bonus], unit: 'R$ ', separator: ',', delimiter: '.') %>
                  </p>
                </div>
              <% end %>

              <!-- Total Geral -->
              <div class="total-section">
                <h3>Total Geral de Bônus</h3>
                <p class="total-value">
                  <%= number_to_currency(@total_bonus, unit: 'R$ ', separator: ',', delimiter: '.') %>
                </p>
              </div>

              <p class="planet-thanks">O Planeta Agradece!</p>
            </td>
          </tr>

          <!-- Footer -->
          <tr>
            <td class="footer">
              <p>
                Este email contém o resumo das reciclagens realizadas.
                Para mais detalhes, acesse a plataforma Ecoenel.
              </p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>
